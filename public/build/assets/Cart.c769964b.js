import{I as j,D as S,_ as L}from"./AuthenticatedLayout.f96130c6.js";import{z as v,P as h,B as E,u as s,o as l,a as d,F as C,K as B,f as t,d as p,t as f,k as $,b as P,R as V,Q as F,H as U}from"./app.4ddaa9db.js";import{_ as H}from"./EtapeOrder.a2c67de5.js";import{_ as N,a as I}from"./ResumeOrderVertical.64d4db90.js";import{_ as A}from"./InputNumber.310bebce.js";import{r as Q}from"./ExclamationCircleIcon.9065525e.js";import"./LangueChoice.37bf89c9.js";const M={key:0,class:"w-full h-90"},z={class:"sm:col-span-2 xsm:col-span-3 col-span-4 flex items-center justify-center"},O={key:0,class:"lg:h-[150px] sm:h-[130px] h-full w-full px-2"},K=["src","alt"],R={key:1,class:"text-3xl m-2 lg:h-[150px] sm:h-[130px] h-full w-full flex items-stretch justify-center bg-gray-300"},G={class:"sm:col-span-10 xsm:col-span-9 col-span-8 flex flex-col xl:text-lg text-sm"},J={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},W={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},X={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Y={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Z={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},D={class:"grid grid-cols-8"},ee={class:"xl:col-span-5 col-span-4 w-full h-8 bg-gray-300 flex items-center justify-center rounded"},te={key:0,class:"editQteForm w-full h-full"},ie=["value"],se=["value"],ne=["value"],re=["value"],ae=["value"],le={class:"xl:col-span-3 col-span-4 sm:mx-4 mx-2"},oe=["onClick"],de={key:1,class:"flex items-center justify-center h-full"},ue=t("span",null,"Votre panier est vide !",-1),ce=[ue],_e={__name:"CartEntrepot",props:["produits","panier"],setup(x){const m=x;var a=v(m.produits),u=v(h().props.value.auth.user[0].client);const c=(_,r)=>_.toFixed(r),y=(_,r)=>{var e=void 0;return _.forEach(n=>{n.classList!=null&&n.classList.length>0&&n.classList.contains(r)&&(e=n)}),e};var w=_=>(Math.round(_*100)/100).toFixed(2),g=_=>{var r=_;return u.value.taux_remise>0&&(r=r-r*(u.value.taux_remise/100)),w(r)},T=(_,r)=>{_.preventDefault();var e=y(_.path,"editQteForm");if(e!=null){var n=new FormData(e);P({idProduit:n.get("id_produit"),quantiter:n.get("qte"),id_panier_edi_list:n.get("id_panier_edi_list"),id_panier_edi:n.get("id_panier_edi"),id_client_edi:n.get("id_client_edi")}).post(route("cart/products/edit"),{preserveScroll:!0,preserveState:!0,onSuccess:i=>{i.props.session.status?(a.value[n.get("key_tab")].panier.id_panier_edi_list=i.props.session.id_panier_edi_list,a.value[n.get("key_tab")].isInPanier=!0,a.value[n.get("key_tab")].panier.quantiter=n.get("qte"),Toast.fire({icon:"success",title:"La quantiter du produit "+r+" \xE0 bien \xE9t\xE9 modifier"})):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la modification de la quantiter du produit."})}})}},q=(_,r,e)=>{Swal.fire({title:"Attention",text:"Etes-vous sur de supprimer cette article du panier ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Non",confirmButtonText:"Oui"}).then(n=>{n.isConfirmed&&P({id_panier_edi_list:_,id_panier_edi:r}).post(route("cart/products/delete"),{preserveScroll:!0,onSuccess:i=>{i.props.session.status?Toast.fire({icon:"success",title:"Le produit \xE0 bien \xE9t\xE9 supprimer du panier"}):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la supression du produit du panier"})}})})};return E(()=>{a.value=h().props.value.Panier.panier.panier}),(_,r)=>s(a)!=null?(l(),d("div",M,[(l(!0),d(C,null,B(s(a),(e,n)=>(l(),d("div",{key:n,class:"w-full lg:p-4 sm:p-3 p-2 grid bg-gray-100 rounded grid-cols-12 my-2"},[t("div",z,[e.photo!=null?(l(),d("div",O,[t("img",{src:"https://gestion.tapis-nazar.fr/img/produit/"+e.photo.img_produit,alt:e.code_sku,class:"w-full h-full object-cover rounded-xl"},null,8,K)])):(l(),d("div",R,[p(j)]))]),t("div",G,[t("span",J,"SKU : "+f(e.code_sku),1),t("span",W,"Taille : "+f(e.dimension.largeur+"x"+e.dimension.longueur),1),t("span",X,"Prix du M\xB2 : "+f(s(g)(e.gamme.prix_vente_ht_m2))+" \u20AC HT",1),t("span",Y,"M\xB2 : "+f(c(e.dimension.largeur/100*(e.dimension.longueur/100)*e.panier.quantiter,2))+" m\xB2",1),t("span",Z,"Prix HT : "+f(c(e.dimension.largeur/100*(e.dimension.longueur/100)*e.panier.quantiter*s(g)(e.gamme.prix_vente_ht_m2),2))+" \u20AC",1),t("div",D,[t("div",ee,[e.stats_produit.stock_restant>0?(l(),d("form",te,[p(A,{onChange:o=>s(T)(o,e.design.nom_design+e.dimension.largeur+"x"+e.dimension.longueur),name:"qte",max:e.stats_produit.stock_restant,value:e.panier.quantiter>0?e.panier.quantiter:1,class:"h-full"},null,8,["onChange","max","value"]),t("input",{type:"hidden",name:"id_produit",value:e.id_produit},null,8,ie),t("input",{type:"hidden",name:"id_panier_edi_list",value:e.panier.id_panier_edi_list!=null?e.panier.id_panier_edi_list:0},null,8,se),t("input",{type:"hidden",name:"key_tab",value:n},null,8,ne),t("input",{type:"hidden",name:"id_panier_edi",value:s(m).panier.id_panier_edi!=null?s(m).panier.id_panier_edi:0},null,8,re),t("input",{type:"hidden",name:"id_client_edi",value:e.panier.id_client_edi!=null?e.panier.id_client_edi:0},null,8,ae)])):$("",!0)]),t("div",le,[t("button",{type:"button",onClick:o=>s(q)(e.panier.id_panier_edi_list!=null?e.panier.id_panier_edi_list:0,s(m).panier.id_panier_edi!=null?s(m).panier.id_panier_edi:0,n),class:"w-full bg-red-500 text-white rounded hover:bg-red-300 transition duration-300 h-full"},[p(S,{class:"text-white"})],8,oe)])])])]))),128))])):(l(),d("div",de,ce))}},pe={key:0,class:"w-full h-90"},me={class:"flex items-center justify-center"},fe={class:"font-bold text-center text-xl py-1"},he=["onClick"],xe={class:"sm:col-span-2 xsm:col-span-3 col-span-4 flex items-center justify-center"},ve={key:0,class:"lg:h-[150px] sm:h-[130px] h-full w-full px-2"},ge=["src","alt"],ye={key:1,class:"text-3xl m-2 lg:h-[150px] sm:h-[130px] h-full w-full flex items-stretch justify-center bg-gray-300"},be={class:"sm:col-span-10 xsm:col-span-9 col-span-8 flex flex-col xl:text-lg text-sm"},ke={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},$e={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},we={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Ce={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Pe={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Te={class:"grid grid-cols-8"},qe={class:"xl:col-span-5 col-span-4 w-full h-8 bg-gray-300 flex items-center justify-center rounded"},Se={key:0,class:"editQteForm w-full h-full"},Be=["value"],Ee=["value"],Le=["value"],Fe=["value"],je=["value"],Ae={class:"xl:col-span-3 col-span-4 sm:mx-4 mx-2"},Ve=["onClick"],Ue={key:1,class:"text-center py-5"},He=t("span",{class:"text-lg"},"Le panier de se client est vide !",-1),Ne=[He],Ie={key:1,class:"flex items-center justify-center h-full"},Qe=t("span",null,"Votre panier est vide !",-1),Me=[Qe],ze={__name:"CartDropshipping",props:["panier"],setup(x){var a=v(x.panier),u=v(h().props.value.auth.user[0].client);const c=(r,e)=>r.toFixed(e),y=(r,e)=>{var n=void 0;return r.forEach(o=>{o.classList!=null&&o.classList.length>0&&o.classList.contains(e)&&(n=o)}),n};var w=r=>(Math.round(r*100)/100).toFixed(2),g=r=>{var e=r;return u.value.taux_remise>0&&(e=e-e*(u.value.taux_remise/100)),w(e)},T=(r,e,n)=>{r.preventDefault();var o=y(r.path,"editQteForm");if(o!=null){var i=new FormData(o);P({idProduit:i.get("id_produit"),quantiter:i.get("qte"),id_panier_edi_list:i.get("id_panier_edi_list"),id_panier_edi:i.get("id_panier_edi"),id_client_edi:i.get("id_client_edi")}).post(route("dropshipping/cart/products/edit"),{preserveScroll:!0,preserveState:!0,onSuccess:k=>{k.props.session.status?(console.log(a.value.clients[n]),a.value.clients[n].produits[i.get("key_tab")].id_panier_edi_list=k.props.session.id_panier_edi_list,a.value.clients[n].produits[i.get("key_tab")].isInPanier=!0,a.value.clients[n].produits[i.get("key_tab")].quantiter=i.get("qte"),Toast.fire({icon:"success",title:"La quantiter du produit "+e+" \xE0 bien \xE9t\xE9 modifier"})):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la modification de la quantiter du produit."})}})}},q=(r,e,n)=>{Swal.fire({title:"Attention",text:"Etes-vous sur de supprimer cette article du panier ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Non",confirmButtonText:"Oui"}).then(o=>{o.isConfirmed&&P({id_panier_edi_list:r,id_panier_edi:e}).post(route("dropshipping/cart/products/delete"),{preserveScroll:!0,onSuccess:b=>{b.props.session.status?Toast.fire({icon:"success",title:"Le produit \xE0 bien \xE9t\xE9 supprimer du panier"}):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la supression du produit du panier"})}})})},_=(r,e,n)=>{r.preventDefault(),Swal.fire({title:"Attention",text:"Etes-vous sur de supprimer la commande client "+n+" ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Non",confirmButtonText:"Oui"}).then(o=>{o.isConfirmed&&V.Inertia.post("/dropshipping/cart/client/delete",{id_client_edi:e,id_panier_edi:a.value.id_panier_edi},{onSuccess:i=>{i.props.session.status==!0?Toast.fire({icon:"success",title:"La commande client "+n+" \xE0 bien \xE9t\xE9 suprimmer !"}):Toast.fire({icon:"error",title:"Une erreur s'est produite lors de la supression de la commande client"+n+", veuillez ressayer !"})}})})};return E(()=>{a.value=h().props.value.PanierDrop.panier}),(r,e)=>s(a).clients!=null?(l(),d("div",pe,[(l(!0),d(C,null,B(s(a).clients,(n,o)=>(l(),d("div",{key:o,class:"w-full lg:p-4 sm:p-3 p-2 my-2 bg-gray-100 rounded"},[t("div",me,[t("h2",fe,"Commande : "+f(n.client.ref_externe),1),t("button",{type:"button",onClick:i=>s(_)(i,n.client.id_client_edi!=null?n.client.id_client_edi:0,n.client.ref_externe),class:"mx-2 w-10 bg-red-500 text-white rounded hover:bg-red-300 transition duration-300 h-full"},[p(S,{class:"text-white"})],8,he)]),n.nbProduit>0?(l(!0),d(C,{key:0},B(n.produits,(i,b)=>(l(),d("div",{key:b,class:"grid grid-cols-12 py-4"},[t("div",xe,[i.photo!=null?(l(),d("div",ve,[t("img",{src:"https://gestion.tapis-nazar.fr/img/produit/"+i.photo.img_produit,alt:i.code_sku,class:"w-full h-full object-cover rounded-xl"},null,8,ge)])):(l(),d("div",ye,[p(j)]))]),t("div",be,[t("span",ke,"SKU : "+f(i.code_sku),1),t("span",$e,"Taille : "+f(i.dimension.largeur+"x"+i.dimension.longueur),1),t("span",we,"Prix du M\xB2 : "+f(s(g)(i.gamme.prix_vente_ht_m2))+" \u20AC HT",1),t("span",Ce,"M\xB2 : "+f(c(i.dimension.largeur/100*(i.dimension.longueur/100)*i.panier.quantiter,2))+" m\xB2",1),t("span",Pe,"Prix HT : "+f(c(i.dimension.largeur/100*(i.dimension.longueur/100)*i.panier.quantiter*s(g)(i.gamme.prix_vente_ht_m2),2))+" \u20AC",1),t("div",Te,[t("div",qe,[i.stats_produit.stock_restant>0?(l(),d("form",Se,[p(A,{onChange:k=>s(T)(k,i.design.nom_design+i.dimension.largeur+"x"+i.dimension.longueur,o),name:"qte",max:i.stats_produit.stock_restant,value:i.quantiter>0?i.quantiter:1,class:"h-full"},null,8,["onChange","max","value"]),t("input",{type:"hidden",name:"id_produit",value:i.id_produit},null,8,Be),t("input",{type:"hidden",name:"id_panier_edi_list",value:i.id_panier_edi_list!=null?i.id_panier_edi_list:0},null,8,Ee),t("input",{type:"hidden",name:"key_tab",value:b},null,8,Le),t("input",{type:"hidden",name:"id_panier_edi",value:s(a).id_panier_edi!=null?s(a).id_panier_edi:0},null,8,Fe),t("input",{type:"hidden",name:"id_client_edi",value:n.client.id_client_edi!=null?n.client.id_client_edi:0},null,8,je)])):$("",!0)]),t("div",Ae,[t("button",{type:"button",onClick:k=>s(q)(i.panier.id_panier_edi_list!=null?i.panier.id_panier_edi_list:0,s(a).id_panier_edi!=null?s(a).id_panier_edi:0,r.key),class:"w-full bg-red-500 text-white rounded hover:bg-red-300 transition duration-300 h-full"},[p(S,{class:"text-white"})],8,Ve)])])])]))),128)):(l(),d("div",Ue,Ne))]))),128))])):(l(),d("div",Ie,Me))}},Oe={class:"container mx-auto mt-5"},Ke=t("h1",{class:"font-semibold text-lg lg:text-2xl sm:text-xl text-gray-800 text-center py-2"},"Panier",-1),Re={class:"grid grid-cols-4"},Ge={class:"xl:col-span-1 col-span-4"},Je={class:"xl:col-span-2 lg:col-span-3 col-span-4 flex flex-col items-start justify-center"},We={key:0,class:"w-full bg-yellow-200 px-4 py-2 rounded flex items-center"},Xe=t("span",{class:"pl-2 text-yellow-600"},"Pour continuer, veuillez ajouter au minimum un produit pour chaque commande.",-1),Ye={class:"lg:hidden block col-span-4"},Ze={class:"lg:block hidden col-span-1 ml-5"},De={layout:(x,m)=>x(L,()=>child),layout:L},lt=Object.assign(De,{__name:"Cart",props:["panier","produits"],setup(x){const m=x;var a=v(h().props.value.Panier.panier.panier),u=v(h().props.value.PanierDrop),c=v(h().props.value.session.typeVente),y=["Panier","Adresse Livraison / Facturation","Finaliser commande"];return E(()=>{a.value=h().props.value.Panier.panier.panier,u.value=h().props.value.PanierDrop,c.value=h().props.value.session.typeVente}),(w,g)=>(l(),d(C,null,[p(s(U),{title:"Panier"}),t("section",Oe,[Ke,t("div",Re,[t("div",Ge,[p(H,{etape:1,nbEtape:3,listeEtape:s(y)},null,8,["listeEtape"])]),t("div",Je,[!s(u).panier.panier_valid&&s(c)==2?(l(),d("div",We,[p(s(Q),{class:"h-8 w-8 text-yellow-600"}),Xe])):$("",!0),s(c)==1?(l(),F(_e,{key:1,produits:s(a),panier:m.panier},null,8,["produits","panier"])):$("",!0),s(c)==2?(l(),F(ze,{key:2,panier:s(u)},null,8,["panier"])):$("",!0)]),t("div",Ye,[p(N,{disabled:s(c)==2&&s(u).panier!=null?!s(u).panier.panier_valid:!1,linkEtapeSuivant:s(c)==1?"/cart/adresses":"/dropshipping/cart/adresses",titreLink:"Valider la commande",panier:s(c)==1?m.panier:s(u).panier.panierActuel!=null?s(u).panier.panierActuel:void 0,isButtonSubmit:!1},null,8,["disabled","linkEtapeSuivant","panier"])]),t("div",Ze,[p(I,{disabled:s(c)==2&&s(u).panier!=null?!s(u).panier.panier_valid:!1,linkEtapeSuivant:s(c)==1?"/cart/adresses":"/dropshipping/cart/adresses",titreLink:"Valider la commande",panier:s(c)==1?m.panier:s(u).panier.panierActuel!=null?s(u).panier.panierActuel:void 0,isButtonSubmit:!1},null,8,["disabled","linkEtapeSuivant","panier"])])])])],64))}});export{lt as default};
