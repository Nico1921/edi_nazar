import{I as V,D as B,_ as A}from"./AuthenticatedLayout.800c7a17.js";import{o as r,a,f as i,A as y,I as v,C as j,u as e,J as q,k as x,F as w,K as L,d as f,t as h,b as S,M as H,H as M}from"./app.f7b32b5b.js";import{_ as U}from"./EtapeOrder.63baf979.js";import{_ as I,a as N}from"./ResumeOrderVertical.74a659a0.js";import{_ as z}from"./InputNumber.ef39a405.js";import{r as Q}from"./ExclamationCircleIcon.15ab1e91.js";import"./flag-icons.min.3dbbb609.js";function F(g,p){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495zM10 5a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 0110 5zm0 9a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"})])}const O={key:0,class:"w-full bg-red-200 px-4 py-2 rounded flex items-center"},K={key:1,class:"pl-2 text-red-600"},R={key:1,class:"w-full h-90"},J={class:"sm:col-span-2 xsm:col-span-3 col-span-4 flex items-center justify-center"},D={key:0,class:"h-full w-full lg:max-h-52 max-h-42 px-2"},G=["src","alt"],W={key:1,class:"text-3xl m-2 lg:h-[150px] sm:h-[130px] h-full w-full flex items-stretch justify-center bg-gray-300"},X={class:"sm:col-span-10 xsm:col-span-9 col-span-8 flex flex-col xl:text-lg text-sm"},Y={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},Z={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},ee={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},te={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},ie={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},se={class:"grid grid-cols-8 lg:w-1/2"},ne={class:"xl:col-span-5 col-span-4 w-full h-8 bg-gray-300 flex items-center justify-center rounded"},re={key:0,class:"editQteForm w-full h-full"},ae=["value"],le=["value"],oe=["value"],de=["value"],ce=["value"],ue={class:"xl:col-span-3 col-span-4 sm:mx-4 mx-2"},pe=["onClick"],_e={key:2,class:"flex items-center justify-center h-full"},me=i("span",null,"Votre panier est vide !",-1),fe=[me],he={__name:"CartEntrepot",props:["produits","panier"],setup(g){const p=g;var o=y(p.produits),u=y(v().props.value.auth.user[0].client);const d=(_,m)=>_.toFixed(m),b=(_,m)=>{var t=void 0;return _.forEach(n=>{n.classList!=null&&n.classList.length>0&&n.classList.contains(m)&&(t=n)}),t};var $=_=>(Math.round(_*100)/100).toFixed(2),k=_=>{var m=_;return u.value.taux_remise>0&&(m=m-m*(u.value.taux_remise/100)),$(m)},C=(_,m)=>{_.preventDefault();var t=b(_.path,"editQteForm");if(t!=null){var n=new FormData(t);S({idProduit:n.get("id_produit"),quantiter:n.get("qte"),id_panier_edi_list:n.get("id_panier_edi_list"),id_panier_edi:n.get("id_panier_edi"),id_client_edi:n.get("id_client_edi")}).post(route("cart/products/edit"),{preserveScroll:!0,preserveState:!0,onSuccess:c=>{c.props.session.status?(o.value[n.get("key_tab")].panier.id_panier_edi_list=c.props.session.id_panier_edi_list,o.value[n.get("key_tab")].isInPanier=!0,o.value[n.get("key_tab")].panier.quantiter=n.get("qte"),Toast.fire({icon:"success",title:"La quantiter du produit "+m+" \xE0 bien \xE9t\xE9 modifier"})):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la modification de la quantiter du produit."})}})}},T=(_,m,t)=>{Swal.fire({title:"Attention",text:"Etes-vous sur de supprimer cette article du panier ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Non",confirmButtonText:"Oui"}).then(n=>{n.isConfirmed&&S({id_panier_edi_list:_,id_panier_edi:m}).post(route("cart/products/delete"),{preserveScroll:!0,onSuccess:c=>{c.props.session.status?Toast.fire({icon:"success",title:"Le produit \xE0 bien \xE9t\xE9 supprimer du panier"}):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la supression du produit du panier"})}})})};return j(()=>{o.value=v().props.value.Panier.panier.panier}),console.log(p.panier),(_,m)=>(r(),a(w,null,[e(p).panier.is_validate?(r(),a("div",O,[e(p).panier.is_validate?(r(),q(e(F),{key:0,class:"h-8 w-8 text-red-600"})):x("",!0),e(p).panier.is_validate?(r(),a("span",K,"Votre panier a d\xE9j\xE0 \xE9t\xE9 valider, vous pouvez aller dans Exp\xE9ditions pour voir les d\xE9tails de votre commande.")):x("",!0)])):x("",!0),e(o)!=null?(r(),a("div",R,[(r(!0),a(w,null,L(e(o),(t,n)=>(r(),a("div",{key:n,class:"w-full lg:p-4 sm:p-3 p-2 grid bg-gray-100 rounded grid-cols-12 my-2"},[i("div",J,[t.photo!=null?(r(),a("div",D,[i("img",{src:"https://gestion.tapis-nazar.fr/img/produit/"+t.photo.img_produit,alt:t.code_sku,class:"w-full h-full object-cover rounded-xl"},null,8,G)])):(r(),a("div",W,[f(V)]))]),i("div",X,[i("span",Y,"SKU : "+h(t.code_sku),1),i("span",Z,"Taille : "+h(t.dimension.largeur+"x"+t.dimension.longueur),1),i("span",ee,"Prix du M\xB2 : "+h(e(k)(t.gamme.prix_vente_ht_m2))+" \u20AC HT",1),i("span",te,"M\xB2 : "+h(d(t.dimension.largeur/100*(t.dimension.longueur/100)*t.panier.quantiter,2))+" m\xB2",1),i("span",ie,"Prix HT : "+h(d(t.dimension.largeur/100*(t.dimension.longueur/100)*t.panier.quantiter*e(k)(t.gamme.prix_vente_ht_m2),2))+" \u20AC",1),i("div",se,[i("div",ne,[t.stats_produit.stock_restant>0?(r(),a("form",re,[f(z,{onChange:l=>e(C)(l,t.design.nom_design+t.dimension.largeur+"x"+t.dimension.longueur),name:"qte",max:t.stats_produit.stock_restant,value:t.panier.quantiter>0?t.panier.quantiter:1,class:"h-full"},null,8,["onChange","max","value"]),i("input",{type:"hidden",name:"id_produit",value:t.id_produit},null,8,ae),i("input",{type:"hidden",name:"id_panier_edi_list",value:t.panier.id_panier_edi_list!=null?t.panier.id_panier_edi_list:0},null,8,le),i("input",{type:"hidden",name:"key_tab",value:n},null,8,oe),i("input",{type:"hidden",name:"id_panier_edi",value:e(p).panier.id_panier_edi!=null?e(p).panier.id_panier_edi:0},null,8,de),i("input",{type:"hidden",name:"id_client_edi",value:t.panier.id_client_edi!=null?t.panier.id_client_edi:0},null,8,ce)])):x("",!0)]),i("div",ue,[i("button",{type:"button",onClick:l=>e(T)(t.panier.id_panier_edi_list!=null?t.panier.id_panier_edi_list:0,e(p).panier.id_panier_edi!=null?e(p).panier.id_panier_edi:0,n),class:"w-full bg-red-500 text-white rounded hover:bg-red-300 transition duration-300 h-full"},[f(B,{class:"text-white"})],8,pe)])])])]))),128))])):(r(),a("div",_e,fe))],64))}},ve={key:0,class:"w-full bg-red-200 px-4 py-2 rounded flex items-center"},xe={key:1,class:"pl-2 text-red-600"},ge={key:1,class:"w-full h-90"},ye={class:"flex items-center justify-center"},be={class:"font-bold text-center text-xl py-1"},ke=["onClick"],we={class:"sm:col-span-2 xsm:col-span-3 col-span-4 flex items-center justify-center"},$e={key:0,class:"h-full w-full lg:max-h-52 max-h-42 px-2"},Ce=["src","alt"],Pe={key:1,class:"text-3xl m-2 lg:h-[150px] sm:h-[130px] h-full w-full flex items-stretch justify-center bg-gray-300"},Ee={class:"sm:col-span-10 xsm:col-span-9 col-span-8 flex flex-col xl:text-lg text-sm"},Te={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},qe={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},Se={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},Be={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},Le={class:"text-gray-600 sm:text-lg text-[0.700rem] font-bold"},je={class:"grid grid-cols-8 lg:w-1/2"},Fe={class:"xl:col-span-5 col-span-4 w-full h-8 bg-gray-300 flex items-center justify-center rounded"},Ae={key:0,class:"editQteForm w-full h-full"},Ve=["value"],ze=["value"],He=["value"],Me=["value"],Ue=["value"],Ie={class:"xl:col-span-3 col-span-4 sm:mx-4 mx-2"},Ne=["onClick"],Qe={key:1,class:"text-center py-5"},Oe=i("span",{class:"text-lg"},"Le panier de se client est vide !",-1),Ke=[Oe],Re={key:2,class:"flex items-center justify-center h-full"},Je=i("span",null,"Votre panier est vide !",-1),De=[Je],Ge={__name:"CartDropshipping",props:["panier"],setup(g){var o=y(g.panier),u=y(v().props.value.auth.user[0].client),d=o.value.panier.panierActuel!=null?o.value.panier.panierActuel.is_validate:void 0;const b=(t,n)=>t.toFixed(n),$=(t,n)=>{var l=void 0;return t.forEach(c=>{c.classList!=null&&c.classList.length>0&&c.classList.contains(n)&&(l=c)}),l};var k=t=>(Math.round(t*100)/100).toFixed(2),C=t=>{var n=t;return u.value.taux_remise>0&&(n=n-n*(u.value.taux_remise/100)),k(n)},T=(t,n,l)=>{t.preventDefault();var c=$(t.path,"editQteForm");if(c!=null){var s=new FormData(c);S({idProduit:s.get("id_produit"),quantiter:s.get("qte"),id_panier_edi_list:s.get("id_panier_edi_list"),id_panier_edi:s.get("id_panier_edi"),id_client_edi:s.get("id_client_edi")}).post(route("dropshipping/cart/products/edit"),{preserveScroll:!0,preserveState:!0,onSuccess:E=>{E.props.session.status?(console.log(o.value.clients[l]),o.value.clients[l].produits[s.get("key_tab")].id_panier_edi_list=E.props.session.id_panier_edi_list,o.value.clients[l].produits[s.get("key_tab")].isInPanier=!0,o.value.clients[l].produits[s.get("key_tab")].quantiter=s.get("qte"),Toast.fire({icon:"success",title:"La quantiter du produit "+n+" \xE0 bien \xE9t\xE9 modifier"})):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la modification de la quantiter du produit."})}})}},_=(t,n,l)=>{Swal.fire({title:"Attention",text:"Etes-vous sur de supprimer cette article du panier ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Non",confirmButtonText:"Oui"}).then(c=>{c.isConfirmed&&S({id_panier_edi_list:t,id_panier_edi:n}).post(route("dropshipping/cart/products/delete"),{preserveScroll:!0,onSuccess:P=>{P.props.session.status?Toast.fire({icon:"success",title:"Le produit \xE0 bien \xE9t\xE9 supprimer du panier"}):Toast.fire({icon:"error",title:"Une erreur c'est produit lors de la supression du produit du panier"})}})})},m=(t,n,l)=>{t.preventDefault(),Swal.fire({title:"Attention",text:"Etes-vous sur de supprimer la commande client "+l+" ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Non",confirmButtonText:"Oui"}).then(c=>{c.isConfirmed&&H.Inertia.post("/dropshipping/cart/client/delete",{id_client_edi:n,id_panier_edi:o.value.id_panier_edi},{onSuccess:s=>{s.props.session.status==!0?Toast.fire({icon:"success",title:"La commande client "+l+" \xE0 bien \xE9t\xE9 suprimmer !"}):Toast.fire({icon:"error",title:"Une erreur s'est produite lors de la supression de la commande client"+l+", veuillez ressayer !"})}})})};return j(()=>{o.value=v().props.value.PanierDrop.panier}),console.log(d),(t,n)=>(r(),a(w,null,[e(d)!=null&&e(d)?(r(),a("div",ve,[e(d)?(r(),q(e(F),{key:0,class:"h-8 w-8 text-red-600"})):x("",!0),e(d)?(r(),a("span",xe,"Votre panier a d\xE9j\xE0 \xE9t\xE9 valider, vous pouvez aller dans Exp\xE9ditions pour voir les d\xE9tails de votre commande.")):x("",!0)])):x("",!0),e(o).clients!=null?(r(),a("div",ge,[(r(!0),a(w,null,L(e(o).clients,(l,c)=>(r(),a("div",{key:c,class:"w-full lg:p-4 sm:p-3 p-2 my-2 bg-gray-100 rounded"},[i("div",ye,[i("h2",be,"Commande : "+h(l.client.ref_externe),1),i("button",{type:"button",onClick:s=>e(m)(s,l.client.id_client_edi!=null?l.client.id_client_edi:0,l.client.ref_externe),class:"mx-2 w-10 bg-red-500 text-white rounded hover:bg-red-300 transition duration-300 h-full"},[f(B,{class:"text-white"})],8,ke)]),l.nbProduit>0?(r(!0),a(w,{key:0},L(l.produits,(s,P)=>(r(),a("div",{key:P,class:"grid grid-cols-12 py-4"},[i("div",we,[s.photo!=null?(r(),a("div",$e,[i("img",{src:"https://gestion.tapis-nazar.fr/img/produit/"+s.photo.img_produit,alt:s.code_sku,class:"w-full h-full object-cover rounded-xl"},null,8,Ce)])):(r(),a("div",Pe,[f(V)]))]),i("div",Ee,[i("span",Te,"SKU : "+h(s.code_sku),1),i("span",qe,"Taille : "+h(s.dimension.largeur+"x"+s.dimension.longueur),1),i("span",Se,"Prix du M\xB2 : "+h(e(C)(s.gamme.prix_vente_ht_m2))+" \u20AC HT",1),i("span",Be,"M\xB2 : "+h(b(s.dimension.largeur/100*(s.dimension.longueur/100)*s.panier.quantiter,2))+" m\xB2",1),i("span",Le,"Prix HT : "+h(b(s.dimension.largeur/100*(s.dimension.longueur/100)*s.panier.quantiter*e(C)(s.gamme.prix_vente_ht_m2),2))+" \u20AC",1),i("div",je,[i("div",Fe,[s.stats_produit.stock_restant>0?(r(),a("form",Ae,[f(z,{onChange:E=>e(T)(E,s.design.nom_design+s.dimension.largeur+"x"+s.dimension.longueur,c),name:"qte",max:s.stats_produit.stock_restant,value:s.quantiter>0?s.quantiter:1,class:"h-full"},null,8,["onChange","max","value"]),i("input",{type:"hidden",name:"id_produit",value:s.id_produit},null,8,Ve),i("input",{type:"hidden",name:"id_panier_edi_list",value:s.id_panier_edi_list!=null?s.id_panier_edi_list:0},null,8,ze),i("input",{type:"hidden",name:"key_tab",value:P},null,8,He),i("input",{type:"hidden",name:"id_panier_edi",value:e(o).id_panier_edi!=null?e(o).id_panier_edi:0},null,8,Me),i("input",{type:"hidden",name:"id_client_edi",value:l.client.id_client_edi!=null?l.client.id_client_edi:0},null,8,Ue)])):x("",!0)]),i("div",Ie,[i("button",{type:"button",onClick:E=>e(_)(s.panier.id_panier_edi_list!=null?s.panier.id_panier_edi_list:0,e(o).id_panier_edi!=null?e(o).id_panier_edi:0,t.key),class:"w-full bg-red-500 text-white rounded hover:bg-red-300 transition duration-300 h-full"},[f(B,{class:"text-white"})],8,Ne)])])])]))),128)):(r(),a("div",Qe,Ke))]))),128))])):(r(),a("div",Re,De))],64))}},We={class:"container mx-auto mt-5"},Xe={class:"font-semibold text-lg lg:text-2xl sm:text-xl text-gray-800 text-center py-2"},Ye={class:"grid grid-cols-4"},Ze={class:"col-span-4"},et={class:"col-span-4 grid grid-cols-4 xl:mx-16"},tt={class:"lg:col-span-3 col-span-4 flex flex-col items-start mt-2"},it={key:0,class:"w-full bg-red-200 px-4 py-2 rounded flex items-center"},st={class:"pl-2 text-red-600"},nt={key:1,class:"w-full bg-yellow-200 px-4 py-2 rounded flex items-center"},rt=i("span",{class:"pl-2 text-yellow-600"},"Pour continuer, veuillez ajouter au minimum un produit pour chaque commande.",-1),at={class:"lg:hidden block col-span-4"},lt={class:"lg:block hidden col-span-1 ml-5"},ot={layout:(g,p)=>g(A,()=>child),layout:A},ht=Object.assign(ot,{__name:"Cart",props:["panier","produits"],setup(g){const p=g;var o=y(v().props.value.Panier.panier.panier),u=y(v().props.value.PanierDrop),d=y(v().props.value.session.typeVente),b=["Panier","Adresse Livraison / Facturation","Finaliser commande"],$=["/cart","/cart/adresses","/cart/validation"],k=["/dropshipping/cart","/dropshipping/cart/adresses","/dropshipping/cart/validation"];return j(()=>{o.value=v().props.value.Panier.panier.panier,u.value=v().props.value.PanierDrop,d.value=v().props.value.session.typeVente}),(C,T)=>(r(),a(w,null,[f(e(M),{title:"Panier - "+(e(d)==1?"Commande Entrep\xF4t":"Dropshipping")},null,8,["title"]),i("section",We,[i("h1",Xe,"Panier - "+h(e(d)==1?"Commande Entrep\xF4t":"Dropshipping"),1),i("div",Ye,[i("div",Ze,[f(U,{hrefEtape:e(d)==1?e($):e(k),etape:1,nbEtape:3,listeEtape:e(b)},null,8,["hrefEtape","listeEtape"])]),i("div",et,[i("div",tt,[e(v)().props.value.session.messageError!=null?(r(),a("div",it,[f(e(F),{class:"h-8 w-8 text-red-600"}),i("span",st,h(e(v)().props.value.session.messageError),1)])):x("",!0),!e(u).panier.panier_valid&&e(d)==2?(r(),a("div",nt,[f(e(Q),{class:"h-8 w-8 text-yellow-600"}),rt])):x("",!0),e(d)==1?(r(),q(he,{key:2,produits:e(o),panier:p.panier},null,8,["produits","panier"])):x("",!0),e(d)==2?(r(),q(Ge,{key:3,panier:e(u)},null,8,["panier"])):x("",!0)]),i("div",at,[f(I,{disabled:e(d)==2&&e(u).panier!=null?!e(u).panier.panier_valid:!1,linkEtapeSuivant:e(d)==1?"/cart/adresses":"/dropshipping/cart/adresses",titreLink:"Valider la commande",panier:e(d)==1?p.panier:e(u).panier.panierActuel!=null?e(u).panier.panierActuel:void 0,isButtonSubmit:!1},null,8,["disabled","linkEtapeSuivant","panier"])]),i("div",lt,[f(N,{disabled:e(d)==2&&e(u).panier!=null?!e(u).panier.panier_valid:!1,linkEtapeSuivant:e(d)==1?"/cart/adresses":"/dropshipping/cart/adresses",titreLink:"Valider la commande",panier:e(d)==1?p.panier:e(u).panier.panierActuel!=null?e(u).panier.panierActuel:void 0,isButtonSubmit:!1},null,8,["disabled","linkEtapeSuivant","panier"])])])])])],64))}});export{ht as default};
