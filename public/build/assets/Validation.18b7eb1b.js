import{A as h,I as $,o as c,a as d,d as o,u as t,f as e,t as l,k as u,F as j,K as z,e as _,i as A,w as g,p as y,h as v,H as I,n as f,S as V}from"./app.5a817674.js";import{_ as P}from"./AuthenticatedLayout.f94672b2.js";import{_ as U}from"./EtapeOrder.aa10ec9a.js";import{y as S,_ as q,r as L,O,g as E,h as F,a as D,b as H,c as K,d as Q}from"./BouttonPaiement.3fa364ce.js";import"./flag-icons.min.3dbbb609.js";import"./label.24ee1de3.js";import"./description.e9e6d878.js";import"./use-controllable.af7e8b3f.js";const R={class:"container mx-auto mt-5"},G={class:"grid grid-cols-4"},J={class:"xl:col-span-1 col-span-4"},W={class:"xl:col-span-3 col-span-4"},X=e("h1",{class:"text-center text-3xl text-primary-300"},"Finalisation de la commande",-1),Y={class:"m-5"},Z={class:"grid grid-cols-2"},ee={class:"bg-primary-50 rounded sm:col-span-1 col-span-2 m-2 flex flex-col p-4"},se=e("h2",{class:"text-center font-bold"},"Adresse de livraison",-1),te={key:0},ae={key:1},le={class:"bg-primary-50 rounded sm:col-span-1 col-span-2 m-2 flex flex-col p-4"},ne=e("h2",{class:"text-center font-bold"},"Adresse de facturation",-1),oe={key:0},ie={key:1},re={class:"bg-primary-50 rounded m-2 p-4"},ce=e("h2",{class:"text-center font-bold"},"Total Commande",-1),de={class:"grid lg:grid-cols-5 grid-cols-4 justify-center flex-row mt-4 mx-6"},me={class:"lg:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},ue={class:"font-semibold text-gray-600"},_e=e("hr",{class:"absolute sm:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),pe={class:"lg:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},xe={class:"font-semibold text-gray-600"},fe=e("hr",{class:"absolute lg:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),he={class:"lg:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},ge={lass:"font-semibold text-gray-600"},ye=e("hr",{class:"absolute sm:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),ve={class:"lg:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},be={lass:"font-semibold text-gray-600"},we=e("hr",{class:"absolute lg:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),ke={class:"lg:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},Ce={lass:"font-semibold text-gray-600"},Te={class:"grid grid-cols-1 flex items-center justify-center my-4 mx-2"},Be=e("h2",{class:"px-5 py-3 bg-primary-50 rounded font-bold text-center"},"Produits",-1),je={key:0,class:"grid 2xl:grid-cols-3 lg:grid-cols-4 w-full p-5 h-90 bg-gray-50 xl:max-h-[calc(100vh-550px)] lg:max-h-[calc(100vh-250px)] max-h-screen overflow-auto"},Ve={class:"w-full lg:p-4 sm:p-3 p-2 grid bg-gray-100 rounded grid-cols-12 my-2"},Pe={class:"xl:col-span-4 lg:col-span-4 sm:col-span-2 xsm:col-span-4 col-span-4 flex items-center justify-center"},Ee={key:0,class:"lg:h-[150px] sm:h-[130px] h-full w-full px-2"},Fe=["src","alt"],He={key:1},Me=e("span",null,"Pas de photo pour ce produit !",-1),Ne=[Me],$e={class:"xl:col-span-8 lg:col-span-8 sm:col-span-10 xsm:col-span-8 col-span-8 flex flex-col xl:text-lg text-sm"},ze={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Ae={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Ie={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Ue={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Se={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},qe={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Le={class:"bg-gray-100 rounded-b-lg"},Oe=e("div",{class:"text-center bg-primary-50 rounded-t-lg py-1"},[e("h2",{class:"text-lg font-bold"},"Moyen de paiement")],-1),De={key:0,class:"bg-yellow-200 px-4 py-2 rounded flex items-center"},Ke=e("span",{class:"pl-2 text-yellow-600"},"Pour continuer, veuillez s\xE9lectionner votre moyen de paiement et accepter les CGV.",-1),Qe={class:"mx-auto w-full my-4"},Re={class:"flex sm:flex-row flex-col w-full sm:justify-evenly justify-center items-center"},Ge={class:"flex w-full items-center justify-between"},Je={class:"flex items-center"},We={class:"text-sm"},Xe=e("span",{class:"ml-2"}," Carte Bancaire",-1),Ye={class:"shrink-0 text-white"},Ze={class:"flex w-full items-center justify-between"},es={class:"flex items-center"},ss={class:"text-sm"},ts=e("span",{class:"ml-2"}," Virement Bancaire",-1),as={class:"shrink-0 text-white"},ls={class:"flex items-center my-6 2xl:mx-28 xl:mx-12 lg:mx-[4.4rem] sm:mx-2 xsm:mx-14 mx-auto max-w-sm"},ns=e("label",{for:"checkVenteCondition",class:"ml-2 sm:text-lg text-sm font-medium text-gray-900"},[v("J'accepte les "),e("a",{href:"/cgv",class:"text-gray-400 underline hover:text-[1.15rem] cursor-pointer transition-all duration-300"},"conditions g\xE9n\xE9rales de vente")],-1),os={class:"py-2"},is={id:"paymentCB",class:"flex items-center justify-center mb-5"},rs={key:0,class:"flex justify-center mb-5"},cs=["disabled"],ds={layout:(x,a)=>x(P,()=>child),layout:P},ys=Object.assign(ds,{__name:"Validation",props:["client","panier","produits"],setup(x){const a=x;var b=h($().props.value.auth.user[0].client),M=["Panier","Adresse Livraison / Facturation","Finaliser commande"];const w=(r,n)=>r.toFixed(n);var p=h(0),i=h(0),k=()=>{V.post("/cart/adresses/validation/order",{paymentType:i.value}).then(r=>{r.status==200?document.location.href="/shippings/order/clients/"+r.data.num_commande:Toast.fire({icon:"error",title:"Une erreur s'est produite lors de l'enregistrement de votre commande, veuillez ressayer !"})})},N=r=>(Math.round(r*100)/100).toFixed(2),C=r=>{var n=r;return b.value.taux_remise>0&&(n=n-n*(b.value.taux_remise/100)),N(n)},T=(r,n)=>{n==2&&document.getElementById("paymentCB").getElementsByTagName("form").length===0&&V.post("/cart/payment/cb",{paymentType:i.value}).then(s=>{if(s.status==200)if(s.data.statut){var m=document.getElementById("bouttonPaiement");document.getElementById("paymentCB").innerHTML=s.data.formpay,document.getElementById("submitPayButton").appendChild(m)}else Toast.fire({icon:"error",title:s.data.msg});else Toast.fire({icon:"error",title:"Une erreur s'est produite lors de la g\xE9n\xE9ration du formulaire de paiement, veuillez ressayer !"})})},B=r=>{r.target.checked?p.value=!0:p.value=!1};return(r,n)=>(c(),d(j,null,[o(t(I),{title:"Validation - Panier"}),e("section",R,[e("div",G,[e("div",J,[o(U,{etape:3,nbEtape:3,listeEtape:t(M)},null,8,["listeEtape"])]),e("div",W,[X,e("div",Y,[e("div",Z,[e("div",ee,[se,e("span",null,l(a.client.nom_adresse)+",",1),e("span",null,l(a.client.adresse1)+",",1),a.client.adresse2!=""&&a.client.adresse2!=null?(c(),d("span",te,l(a.client.adresse2)+",",1)):u("",!0),a.client.adresse3!=""&&a.client.adresse3!=null?(c(),d("span",ae,l(a.client.adresse3)+",",1)):u("",!0),e("span",null,l(a.client.code_postal+", "+a.client.ville)+",",1),e("span",null,l(a.client.pays),1)]),e("div",le,[ne,e("span",null,l(a.client.nom_adresse_facturation)+",",1),e("span",null,l(a.client.adresse1_facturation)+",",1),a.client.adresse2_facturation!=""&&a.client.adresse2_facturation!=null?(c(),d("span",oe,l(a.client.adresse2_facturation)+",",1)):u("",!0),a.client.adresse3_facturation!=""&&a.client.adresse3_facturation!=null?(c(),d("span",ie,l(a.client.adresse3_facturation)+",",1)):u("",!0),e("span",null,l(a.client.code_postal_facturation+", "+a.client.ville_facturation)+",",1),e("span",null,l(a.client.pays_facturation),1)])]),e("div",re,[ce,e("div",de,[e("div",me,[e("span",ue,"Quantiter : "+l(a.panier.produits_total)+" pcs",1),_e]),e("div",pe,[e("span",xe,"M\xB2 : "+l(a.panier.total_m2)+" m\xB2",1),fe]),e("div",he,[e("span",ge,"Prix HT : "+l(a.panier.total_HT)+" \u20AC",1),ye]),e("div",ve,[e("span",be,"Prix TVA : "+l(a.panier.total_taxe)+" \u20AC",1),we]),e("div",ke,[e("span",Ce,"Prix TTC : "+l(a.panier.total_ttc)+" \u20AC",1)])])]),e("div",Te,[Be,x.produits!=null?(c(),d("div",je,[(c(!0),d(j,null,z(a.produits.panier,(s,m)=>(c(),d("div",{key:m,class:"2xl:col-span-1 lg:col-span-2 col-span-4 w-full px-2"},[e("div",Ve,[e("div",Pe,[s.photo!=null?(c(),d("div",Ee,[e("img",{src:"https://gestion.tapis-nazar.fr/img/produit/"+s.photo.img_produit,alt:s.code_sku,class:"w-full h-full object-cover rounded-xl"},null,8,Fe)])):(c(),d("div",He,Ne))]),e("div",$e,[e("span",ze,"SKU : "+l(s.code_sku),1),e("span",Ae,"Taille : "+l(s.dimension.largeur+"x"+s.dimension.longueur),1),e("span",Ie,"Prix du M\xB2 : "+l(t(C)(s.gamme.prix_vente_ht_m2))+" \u20AC HT",1),e("span",Ue,"M\xB2 : "+l(w(s.dimension.largeur/100*(s.dimension.longueur/100)*s.panier.quantiter,2))+" m\xB2",1),e("span",Se,"Quantiter : "+l(s.panier.quantiter),1),e("span",qe,"Prix HT : "+l(w(s.dimension.largeur/100*(s.dimension.longueur/100)*s.panier.quantiter*t(C)(s.gamme.prix_vente_ht_m2),2))+" \u20AC",1)])])]))),128))])):u("",!0)]),e("div",Le,[Oe,t(i)==0||!t(p)?(c(),d("div",De,[o(t(L),{class:"h-8 w-8 text-yellow-600"}),Ke])):u("",!0),e("div",Qe,[o(t(S),{modelValue:t(i),"onUpdate:modelValue":n[2]||(n[2]=s=>A(i)?i.value=s:i=s)},{default:_(()=>[o(t(O),{class:"sr-only"},{default:_(()=>[v("Type de paiement")]),_:1}),e("div",Re,[o(t(E),{as:"template",value:"2",onClick:n[0]||(n[0]=s=>t(T)(s,2))},{default:_(({active:s,checked:m})=>[e("div",{class:f([[s?"ring-2 ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-300":"",m?"bg-blue-900 bg-opacity-75 text-white ":"bg-white "],"relative sm:my-0 my-2 mx-2 w-full sm:max-w-sm max-w-xs flex cursor-pointer rounded-lg px-5 py-4 shadow-md focus:outline-none"])},[e("div",Ge,[e("div",Je,[e("div",We,[o(t(F),{as:"span",class:f([m?"text-blue-100":"text-gray-500","inline flex items-center"])},{default:_(()=>[o(t(D),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"}),Xe]),_:2},1032,["class"])])]),g(e("div",Ye,[o(t(H),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"})],512),[[y,m]])])],2)]),_:1}),o(t(E),{as:"template",value:"1",onClick:n[1]||(n[1]=s=>t(T)(s,1))},{default:_(({active:s,checked:m})=>[e("div",{class:f([[s?"ring-2 ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-300":"",m?"bg-blue-900 bg-opacity-75 text-white ":"bg-white "],"relative w-full sm:my-0 my-2 mx-2 sm:max-w-sm max-w-xs flex cursor-pointer rounded-lg px-5 py-4 shadow-md focus:outline-none"])},[e("div",Ze,[e("div",es,[e("div",ss,[o(t(F),{as:"span",class:f([m?"text-blue-100":"text-gray-500","inline flex items-center"])},{default:_(()=>[o(t(K),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"}),ts]),_:2},1032,["class"])])]),g(e("div",as,[o(t(H),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"})],512),[[y,m]])])],2)]),_:1})])]),_:1},8,["modelValue"])]),e("div",ls,[e("input",{onClick:n[3]||(n[3]=(...s)=>t(B)&&t(B)(...s)),id:"checkVenteCondition",type:"checkbox",value:"1",class:"w-4 h-4 text-primary-200 bg-gray-100 border-gray-300 rounded focus:ring-primary-200 focus:ring-2 bg-primary-100"}),ns]),e("div",os,[g(e("div",is,[o(q,{disabled:t(i)==0||!t(p),id:"bouttonPaiement"},null,8,["disabled"])],512),[[y,t(i)==2]]),t(i)==1||t(i)==0?(c(),d("div",rs,[e("button",{disabled:t(i)==0||!t(p),onClick:n[4]||(n[4]=(...s)=>t(k)&&t(k)(...s)),type:"button",class:"py-2 px-4 flex group border border-green-300 rounded bg-green-900 bg-opacity-75 text-white hover:bg-opacity-90 transition duration-300 disabled:cursor-not-allowed disabled:bg-green-300"},[v("Finaliser la commande "),o(t(Q),{class:"h-6 w-6 ml-1 group-hover:translate-x-1 group-disabled:translate-x-0 transition-all duration-300",viewBox:"0 0 24 24",fill:"none"})],8,cs)])):u("",!0)])])])])])])],64))}});export{ys as default};
