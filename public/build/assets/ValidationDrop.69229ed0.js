import{A as h,I as g,b as V,C as F,o as c,a as d,d as n,u as s,f as e,t as o,F as b,J as M,k as v,e as u,i as G,w,p as j,h as I,H as Q,n as f,_ as D}from"./app.ff92c5bb.js";import{_ as k,r as O}from"./AuthenticatedLayout.2aedd0af.js";import{_ as U}from"./EtapeOrder.bf79d591.js";import{y as Z,_ as J,r as q,O as R,g as L,h as A,a as $,b as B}from"./BouttonPaiement.49e6296f.js";import{r as W}from"./ArrowRightCircleIcon.7fdae79d.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./label.b846b038.js";import"./description.109f5e8c.js";import"./use-controllable.d1d57e82.js";const X={class:"container mx-auto mt-5"},K={class:"grid grid-cols-4"},ee={class:"col-span-4"},se={class:"col-span-4 xl:mx-16 lg:mx-8"},te=e("h1",{class:"text-center text-3xl text-primary-300"},"Finalisation de la commande",-1),oe={class:"m-5"},ae={class:"bg-primary-50 rounded m-2 p-4"},le=e("h2",{class:"text-center font-bold"},"Total Commande",-1),ie={class:"grid 2xl:grid-cols-7 grid-cols-4 justify-center flex-row mt-4 mx-6"},ne={class:"2xl:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},re={class:"font-semibold text-gray-600"},ce=e("hr",{class:"absolute sm:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),de={class:"2xl:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},me={class:"font-semibold text-gray-600"},pe=e("hr",{class:"absolute lg:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),_e={class:"2xl:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},ue={lass:"font-semibold text-gray-600"},xe=e("hr",{class:"absolute sm:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),he={class:"2xl:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},ge={lass:"font-semibold text-gray-600"},fe=e("hr",{class:"absolute sm:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),ye={class:"2xl:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},be={lass:"font-semibold text-gray-600"},ve=e("hr",{class:"absolute sm:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),we={class:"2xl:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},je={lass:"font-semibold text-gray-600"},Ie=e("hr",{class:"absolute lg:block hidden w-px h-5 border border-primary-100 right-0"},null,-1),Te={class:"2xl:col-span-1 sm:col-span-2 col-span-4 flex justify-center relative"},Ne={lass:"font-semibold text-gray-600"},Ce={class:"xl:max-h-[calc(100vh-550px)] lg:max-h-[calc(100vh-250px)] max-h-screen sm:px-6 overflow-auto grid grid-cols-1 flex items-center justify-center my-4 mx-2"},Pe={class:"border p-4 rounded-lg shadow-lg hover:shadow-xl transition-shadow"},Me={class:"flex justify-between items-center mb-4"},De={class:"text-xl font-bold"},ke={class:"flex items-center mb-4"},Le={class:"font-bold"},Ae={class:"text-gray-600"},Be=e("div",{class:"border-b border-gray-300 mb-4"},null,-1),Ee={key:0,class:"grid 2xl:grid-cols-3 lg:grid-cols-4 w-full p-5 h-90 bg-gray-50"},ze={class:"w-full lg:p-4 sm:p-3 p-2 grid bg-gray-100 rounded grid-cols-12 my-2"},Ye={class:"xl:col-span-4 lg:col-span-4 sm:col-span-2 xsm:col-span-4 col-span-4 flex items-center justify-center"},He={key:0,class:"lg:h-[150px] sm:h-[130px] h-full w-full px-2"},Se=["src","alt"],Ve={key:1},Fe=e("span",null,"Pas de photo pour ce produit !",-1),Ge=[Fe],Qe={class:"xl:col-span-8 lg:col-span-8 sm:col-span-10 xsm:col-span-8 col-span-8 flex flex-col xl:text-lg text-sm"},Oe={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Ue={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Ze={key:0,class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Je={key:1,class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},qe={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Re={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},$e={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},We={class:"text-gray-600 sm:text-sm text-[0.700rem] font-bold"},Xe={key:1,class:"flex items-center"},Ke=e("span",{class:"font-semibold"},"Panier Vide !",-1),es=[Ke],ss={class:"border-t border-gray-300 mt-4 pt-4 text-right"},ts={class:"font-bold text-xl"},os={class:"bg-gray-100 rounded-b-lg"},as=e("div",{class:"text-center bg-primary-50 rounded-t-lg py-1"},[e("h2",{class:"text-lg font-bold"},"Moyens de paiement")],-1),ls={key:0,class:"bg-yellow-200 px-4 py-2 rounded flex items-center"},is=e("span",{class:"pl-2 text-yellow-600"},"Pour continuer, veuillez s\xE9lectionner votre moyen de paiement et accepter les CGV.",-1),ns={class:"mx-auto w-full my-2"},rs={class:"flex sm:flex-row flex-col w-full sm:justify-evenly justify-center items-center"},cs={class:"flex w-full items-center justify-between"},ds={class:"flex items-center"},ms={class:"text-sm"},ps=e("span",{class:"ml-2"}," Carte Bancaire",-1),_s={class:"shrink-0 text-white"},us={class:"flex w-full items-center justify-between"},xs={class:"flex items-center"},hs={class:"text-sm"},gs=e("span",{class:"ml-2"}," Virement Bancaire",-1),fs={class:"shrink-0 text-white"},ys={class:"flex items-center my-6 mx-auto max-w-sm"},bs=e("label",{for:"checkVenteCondition",class:"ml-2 sm:text-lg text-sm font-medium text-gray-900"},[I("J'accepte les "),e("a",{href:"/cgv",class:"text-gray-400 underline hover:text-[1.15rem] cursor-pointer transition-all duration-300"},"conditions g\xE9n\xE9rales de vente")],-1),vs={class:"py-2"},ws={id:"paymentCB",class:"flex items-center justify-center mb-5"},js={key:0,class:"flex justify-center mb-5"},Is=["disabled"],Ts={layout:(T,y)=>T(k,()=>child),layout:k},Es=Object.assign(Ts,{__name:"ValidationDrop",props:["client","panier","produits"],setup(T){var y=h(g().props.value.PanierDrop.panier.clients),p=h(g().props.value.PanierDrop.panier.panierActuel),E=["/dropshipping/cart","/dropshipping/cart/adresses","/dropshipping/cart/validation"],z=["Panier","Adresse Livraison / Facturation","Finaliser commande"];const Y="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDQwMDAgNDAwMCIgd2lkdGg9IjEwMDAiIGhlaWdodD0iMTAwMCI+PHN0eWxlPi5he2ZpbGw6I2EzYTNhM30uYntmaWxsOiNmZmZ9PC9zdHlsZT48cGF0aCBjbGFzcz0iYSIgZD0ibTQwMDAgNDAwMGgtNDAwMHYtNDAwMGg0MDAweiIvPjxwYXRoIGNsYXNzPSJiIiBkPSJtMzI2NSAzMDQ2Ljh2MjY1LjJoLTI1MzB2LTI2NS4yYzAtNDg5IDU2Ni40LTg4NS41IDEyNjUtODg1LjUgNjk4LjYgMCAxMjY1IDM5Ni41IDEyNjUgODg1LjV6Ii8+PHBhdGggY2xhc3M9ImIiIGQ9Im0yNjI0LjEgMTMxMi4xYzAgMzQ0LjYtMjc5LjQgNjI0LTYyNC4xIDYyNC0zNDQuNyAwLTYyNC4xLTI3OS40LTYyNC4xLTYyNCAwLTM0NC43IDI3OS40LTYyNC4xIDYyNC4xLTYyNC4xIDM0NC43IDAgNjI0LjEgMjc5LjQgNjI0LjEgNjI0LjF6Ii8+PC9zdmc+",H=(m,a)=>parseFloat(m).toFixed(a);var _=m=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(m),r=h(0),x=h(0);V({paymentType:r.value});var N=()=>{const m=document.querySelectorAll(".btnProcess");for(let a=0;a<m.length;a++)m[a].classList.add("opacity-25"),m[a].setAttribute("disabled","disabled");D.post("/dropshipping/cart/validation/order",{paymentType:r.value}).then(a=>{a.status==200?document.location.href="/shippings/order/clients/"+a.data.num_commande:Toast.fire({icon:"error",title:"Une erreur s'est produite lors de l'enregistrement de votre commande, veuillez ressayer !"});const t=document.querySelectorAll(".btnProcess");for(let l=0;l<t.length;l++)t[l].classList.remove("opacity-25"),t[l].removeAttribute("disabled")})};F(()=>{y.value=g().props.value.PanierDrop.panier.clients,p.value=g().props.value.PanierDrop.panier.panierActuel});var C=(m,a)=>{a==2&&document.getElementById("paymentCB").getElementsByTagName("form").length===0&&D.post("/dropshipping/cart/payment/cb",{paymentType:r.value}).then(t=>{if(t.status==200)if(t.data.statut){var l=document.getElementById("bouttonPaiement");document.getElementById("paymentCB").innerHTML=t.data.formpay,document.getElementById("submitPayButton").appendChild(l)}else Toast.fire({icon:"error",title:t.data.msg});else Toast.fire({icon:"error",title:"Une erreur s'est produite lors de la g\xE9n\xE9ration du formulaire de paiement, veuillez ressayer !"})})},P=m=>{m.target.checked?x.value=!0:x.value=!1};return(m,a)=>(c(),d(b,null,[n(s(Q),{title:"Validation - Panier"}),e("section",X,[e("div",K,[e("div",ee,[n(U,{hrefEtape:s(E),etape:3,nbEtape:3,listeEtape:s(z)},null,8,["hrefEtape","listeEtape"])]),e("div",se,[te,e("div",oe,[e("div",ae,[le,e("div",ie,[e("div",ne,[e("span",re,"Quantit\xE9 : "+o(s(p).produits_total)+" pcs",1),ce]),e("div",de,[e("span",me,"M\xB2 : "+o(s(p).total_m2)+" m\xB2",1),pe]),e("div",_e,[e("span",ue,"Montant HT : "+o(s(_)(s(p).montant_ht)),1),xe]),e("div",he,[e("span",ge,"Transport HT : "+o(s(_)(s(p).prix_transport)),1),fe]),e("div",ye,[e("span",be,"Prix HT : "+o(s(_)(s(p).total_HT)),1),ve]),e("div",we,[e("span",je,"Prix TVA : "+o(s(_)(s(p).total_taxe)),1),Ie]),e("div",Te,[e("span",Ne,"Prix TTC : "+o(s(_)(s(p).total_ttc)),1)])])]),e("div",Ce,[(c(!0),d(b,null,M(s(y),(t,l)=>(c(),d("div",{key:l,class:"my-2"},[e("div",Pe,[e("div",Me,[e("h2",De,o(t.client.ref_externe)+" - "+o(t.client.prenom+" "+t.client.nom),1)]),e("div",ke,[e("img",{src:Y,alt:"Logo client",class:"w-12 h-12 rounded-full mr-4"}),e("div",null,[e("p",Le,o(t.client.nom_adresse),1),e("p",Ae,o(t.client.adresse1)+", "+o(t.client.adresse2!=""&&t.client.adresse2!=null?t.client.adresse2+",":"")+" "+o(t.client.adresse3!=""&&t.client.adresse3!=null?t.client.adresse3+",":"")+" "+o(t.client.code_postal)+" "+o(t.client.ville)+", "+o(t.client.pays),1)])]),Be,e("div",null,[t.produits!=null?(c(),d("div",Ee,[t.produits.length>0?(c(!0),d(b,{key:0},M(t.produits,(i,S)=>(c(),d("div",{key:S,class:"2xl:col-span-1 lg:col-span-2 col-span-4 w-full px-2"},[e("div",ze,[e("div",Ye,[i.photo!=null?(c(),d("div",He,[e("img",{src:"https://gestion.tapis-nazar.fr/img/produit/"+i.photo.img_produit,alt:i.code_sku,class:"w-full h-full object-cover rounded-xl"},null,8,Se)])):(c(),d("div",Ve,Ge))]),e("div",Qe,[e("span",Oe,"SKU : "+o(i.code_sku),1),e("span",Ue,"Taille : "+o(i.dimension.largeur+"x"+i.dimension.longueur),1),i.isPrixPieceSpecifique?(c(),d("span",Ze,"Prix par pi\xE8ce : "+o(i.prixPieceSpecifique)+" \u20AC HT",1)):(c(),d("span",Je,"Prix du M\xB2 : "+o(i.gamme.prix_vente_ht_m2_remise)+" \u20AC HT",1)),e("span",qe,"M\xB2 : "+o(H(i.dimension.largeur/100*(i.dimension.longueur/100)*i.panier.quantiter,2))+" m\xB2",1),e("span",Re,"Quantit\xE9 : "+o(i.panier.quantiter),1),e("span",$e,"Prix HT hors transport : "+o(i.panier.prix_ht_total)+" \u20AC",1),e("span",We,"Prix transport HT : "+o(i.prixTransport)+" \u20AC",1)])])]))),128)):(c(),d("div",Xe,es))])):v("",!0)]),e("div",ss,[e("p",ts,"Total commande HT : "+o(s(_)(t.client.total_ht)),1)])])]))),128))]),e("div",os,[as,s(r)==0||!s(x)?(c(),d("div",ls,[n(s(q),{class:"h-8 w-8 text-yellow-600"}),is])):v("",!0),e("div",ns,[n(s(Z),{modelValue:s(r),"onUpdate:modelValue":a[2]||(a[2]=t=>G(r)?r.value=t:r=t)},{default:u(()=>[n(s(R),{class:"sr-only"},{default:u(()=>[I("Type de paiement")]),_:1}),e("div",rs,[n(s(L),{as:"template",value:"2",onClick:a[0]||(a[0]=t=>s(C)(t,2))},{default:u(({active:t,checked:l})=>[e("div",{class:f([[t?"ring-2 ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-300":"",l?"bg-blue-900 bg-opacity-75 text-white ":"bg-white "],"relative sm:my-0 my-2 mx-2 w-full sm:max-w-sm max-w-xs flex cursor-pointer rounded-lg px-5 py-4 shadow-md focus:outline-none"])},[e("div",cs,[e("div",ds,[e("div",ms,[n(s(A),{as:"span",class:f([l?"text-blue-100":"text-gray-500","inline flex items-center"])},{default:u(()=>[n(s($),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"}),ps]),_:2},1032,["class"])])]),w(e("div",_s,[n(s(B),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"})],512),[[j,l]])])],2)]),_:1}),n(s(L),{as:"template",value:"1",onClick:a[1]||(a[1]=t=>s(C)(t,1))},{default:u(({active:t,checked:l})=>[e("div",{class:f([[t?"ring-2 ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-300":"",l?"bg-blue-900 bg-opacity-75 text-white ":"bg-white "],"relative w-full sm:my-0 my-2 mx-2 sm:max-w-sm max-w-xs flex cursor-pointer rounded-lg px-5 py-4 shadow-md focus:outline-none"])},[e("div",us,[e("div",xs,[e("div",hs,[n(s(A),{as:"span",class:f([l?"text-blue-100":"text-gray-500","inline flex items-center"])},{default:u(()=>[n(s(O),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"}),gs]),_:2},1032,["class"])])]),w(e("div",fs,[n(s(B),{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none"})],512),[[j,l]])])],2)]),_:1})])]),_:1},8,["modelValue"]),e("div",ys,[e("input",{onClick:a[3]||(a[3]=(...t)=>s(P)&&s(P)(...t)),id:"checkVenteCondition",type:"checkbox",value:"1",class:"w-4 h-4 text-primary-200 bg-gray-100 border-gray-300 rounded focus:ring-primary-200 focus:ring-2 bg-primary-100"}),bs])]),e("div",vs,[w(e("div",ws,[n(J,{disabled:s(r)==0||!s(x),id:"bouttonPaiement"},null,8,["disabled"])],512),[[j,s(r)==2]]),s(r)==1||s(r)==0?(c(),d("div",js,[e("button",{disabled:s(r)==0||!s(x),onClick:a[4]||(a[4]=(...t)=>s(N)&&s(N)(...t)),type:"button",class:"btnProcess py-2 px-4 flex group border border-green-300 rounded bg-green-900 bg-opacity-75 text-white hover:bg-opacity-90 transition duration-300 disabled:cursor-not-allowed disabled:bg-green-300"},[I("Finaliser la commande "),n(s(W),{class:"h-6 w-6 ml-1 group-hover:translate-x-1 group-disabled:translate-x-0 transition-all duration-300",viewBox:"0 0 24 24",fill:"none"})],8,Is)])):v("",!0)])])])])])])],64))}});export{Es as default};
